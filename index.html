<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
  <title>Catalog Layout (3-Column Masonry)</title>

  <!-- Montserrat -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;600;700;800;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --ci-bg:#238678;

      --paper:#ffffff;
      --ink:#1e3637;
      --muted: rgba(30,54,55,.72);
      --line: rgba(30,54,55,.16);

      --shadow: 0 18px 42px rgba(0,0,0,.12);
      --radius: 18px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: Montserrat, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: var(--ink);
      background: var(--ci-bg);
    }

    .wrap{
      max-width: 1120px;
      margin: 0 auto;
      padding: 14px;
    }

    .sheet{
      background: var(--paper);
      border-radius: 22px;
      overflow: hidden;
      border: 10px solid rgba(255,255,255,.18);
      box-shadow: var(--shadow);
    }

    /* ===== Header ===== */
    .header{
      padding: 18px 18px 14px;
      border-bottom: 1px solid var(--line);
      position: relative;
      background: #fff;
    }

    .topRow{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 14px;
    }

    .brand{
      display:flex;
      align-items:flex-start;
      gap: 12px;
      min-width:0;
    }

    .mark{
      width:44px;height:44px;
      border-radius: 12px;
      border:1px solid var(--line);
      background: rgba(35,134,120,.10);
      display:grid; place-items:center;
      flex:0 0 auto;
    }
    .mark svg{ width:22px;height:22px; fill: var(--ci-bg); }

    .brandText{ min-width:0; }
    .brandText h1{
      margin:0;
      font-size: 26px;
      font-weight: 900;
      letter-spacing: .08em;
      text-transform: uppercase;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      color: var(--ci-bg);
      line-height: 1.05;
    }
    .brandText p{
      margin: 5px 0 0;
      font-size: 12px;
      font-weight: 800;
      letter-spacing: .18em;
      text-transform: uppercase;
      color: rgba(35,134,120,.92);
    }

    /* Price bubble (optional) */
    .bubble{
      border-radius: 999px;
      background: var(--ci-bg);
      color:#fff;
      padding: 14px 16px;
      text-align:center;
      border:1px solid rgba(255,255,255,.25);
      box-shadow: 0 14px 28px rgba(0,0,0,.16);
      min-width: 172px;
      flex:0 0 auto;
    }
    .bubble .t1{
      font-size:12px;
      font-weight:900;
      letter-spacing:.12em;
      text-transform:uppercase;
      margin:0;
    }
    .bubble .t2{
      margin-top:4px;
      font-size:12px;
      opacity:.92;
      font-weight:700;
    }
    .bubble .big{
      margin-top:6px;
      font-size:42px;
      font-weight:900;
      letter-spacing:.02em;
      line-height:1;
    }
    .bubble .unit{
      margin-top:4px;
      font-size:12px;
      font-weight:900;
      letter-spacing:.12em;
      text-transform:uppercase;
      opacity:.9;
    }

    /* Pricing strip */
    .strip{
      margin-top: 14px;
      border-radius: 16px;
      overflow:hidden;
      border:1px solid var(--line);
      display:flex;
    }
    .stripLabel{
      background: var(--ci-bg);
      color:#fff;
      padding: 12px 14px;
      font-weight: 900;
      letter-spacing:.10em;
      text-transform:uppercase;
      display:flex; align-items:center; justify-content:center;
      min-width: 150px;
    }
    .stripNotes{
      padding: 10px 14px;
      display:flex;
      gap: 14px;
      flex-wrap:wrap;
      align-items:center;
      font-size: 12px;
      color: var(--muted);
    }
    .dot{
      width:6px;height:6px;border-radius:50%;
      background: rgba(30,54,55,.55);
      display:inline-block;
      margin-right:8px;
      transform: translateY(-1px);
    }

    /* ===== Controls ===== */
    .controls{
      padding: 12px 18px 16px;
      border-bottom: 1px solid var(--line);
      display:flex;
      gap: 10px;
      flex-wrap:wrap;
      align-items:center;
      background: linear-gradient(to bottom, rgba(35,134,120,.08), rgba(255,255,255,0));
    }

    .chip{
      border:1px solid var(--line);
      background:#fff;
      padding: 9px 12px;
      border-radius:999px;
      font-weight:900;
      font-size: 12px;
      letter-spacing:.06em;
      text-transform:uppercase;
      cursor:pointer;
      user-select:none;
      transition:.18s transform, .18s background, .18s border;
    }
    .chip:hover{ transform: translateY(-1px); }
    .chip.active{
      background: rgba(35,134,120,.12);
      border-color: rgba(35,134,120,.45);
      color: var(--ci-bg);
    }

    .search{
      margin-left:auto;
      flex: 1;
      min-width: 220px;
      display:flex;
      align-items:center;
    }
    .search input{
      width:100%;
      padding: 10px 12px;
      border-radius: 12px;
      border:1px solid var(--line);
      font-weight:700;
      outline:none;
    }

    /* ===== 3-column Masonry (dense) ===== */
    .content{
      padding: 14px;
    }

    .masonry{
      column-count: 1;
      column-gap: 14px;
    }
    @media (min-width: 720px){
      .masonry{ column-count: 2; }
    }
    @media (min-width: 980px){
      .masonry{ column-count: 3; }
    }

    .panel{
      display:inline-block;
      width:100%;
      break-inside: avoid;
      margin: 0 0 14px;
      border: 1px solid var(--line);
      border-radius: var(--radius);
      overflow:hidden;
      background:#fff;
    }

    /* Solid CI bar + white text */
    .panelHead{
      background: var(--ci-bg);
      color:#fff;
      padding: 10px 12px;
      display:flex;
      align-items:center;
      justify-content:space-between;
    }
    .panelHead h2{
      margin:0;
      font-size: 13px;
      font-weight: 900;
      letter-spacing:.14em;
      text-transform:uppercase;
      color:#fff;
    }
    .panelHead .colTitle{
      font-size: 12px;
      font-weight: 800;
      letter-spacing:.10em;
      text-transform:uppercase;
      color: rgba(255,255,255,.88);
      white-space:nowrap;
    }

    .rows{ padding: 10px 12px 14px; }

    .item{
      display:grid;
      grid-template-columns: 1fr auto;
      gap: 10px;
      padding: 14px 0;
      border-bottom: 1px dashed rgba(30,54,55,.16);
    }
    .item:last-child{ border-bottom:none; }

    /* ===== Prefix badges BEFORE name ===== */
    .titleLine{
      display:flex;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
    }
    .badges{
      display:flex;
      gap:6px;
      align-items:center;
    }
    .badge{
      height:22px;
      padding:0 10px;
      border-radius:999px;
      display:inline-flex;
      align-items:center;

      font-size:10px;
      font-weight:900;
      letter-spacing:.10em;
      text-transform:uppercase;

      border:1px solid rgba(255,255,255,.22);
      background: var(--ci-bg);
      color:#fff;
    }
    .badge.best{
      box-shadow: 0 10px 22px rgba(35,134,120,.22);
    }
    .badge.new{
      background:#fff;
      color: var(--ci-bg);
      border:1px solid rgba(35,134,120,.45);
    }
    .badge.reco{
      background: rgba(35,134,120,.92);
      border-color: rgba(255,255,255,.18);
    }

    .name{
      font-weight: 900;
      font-size: 14px;
      letter-spacing:.02em;
      text-transform:uppercase;
    }

    /* Terpene tags */
    .tags{
      margin-top: 8px;
      display:flex;
      gap: 8px;
      flex-wrap:wrap;
    }
    .tag{
      font-size: 11px;
      font-weight: 800;
      letter-spacing:.02em;
      padding: 6px 10px;
      border-radius: 999px;
      display:inline-flex;
      align-items:center;
      gap: 8px;

      background: rgba(30,54,55,.06);
      border: 1px solid rgba(30,54,55,.16);
      color: rgba(30,54,55,.90);
      text-transform: uppercase;
    }
    .tag::before{
      content:"";
      width:8px;height:8px;border-radius:50%;
      background: currentColor;
      opacity:.9;
    }

    .meta{
      text-align:right;
      white-space:nowrap;
      align-self:center;
    }
    .meta .k{
      display:block;
      font-size:10px;
      font-weight:900;
      letter-spacing:.12em;
      text-transform:uppercase;
      color: rgba(30,54,55,.55);
    }
    .meta .v{
      display:block;
      margin-top:6px;
      font-size: 13px;
      font-weight: 900;
      color: rgba(30,54,55,.88);
    }

    .empty{
      border:1px solid var(--line);
      border-radius: var(--radius);
      padding: 18px;
      background:#fff;
    }
    .empty .t{
      font-weight:900;
      letter-spacing:.06em;
      text-transform:uppercase;
    }
    .empty .d{
      margin-top:6px;
      color: var(--muted);
      font-weight:700;
      font-size: 13px;
    }

    @media (max-width:520px){
      .brandText h1{ font-size: 22px; }
      .bubble{ min-width: 150px; }
      .bubble .big{ font-size: 38px; }
      .stripLabel{ min-width: 120px; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="sheet">

      <header class="header">
        <div class="topRow">
          <div class="brand">
            <div class="mark" aria-hidden="true">
              <svg viewBox="0 0 24 24">
                <path d="M12 2c.4 2.4.5 4.6.3 6.6 1.7-1.3 3.8-2.3 6.3-3-1.2 2.3-3 4.2-5.1 5.6 2.2.1 4.4.6 6.5 1.6-2 1.2-4.2 1.9-6.4 2 2 1.6 3.6 3.6 4.6 6-2.6-.7-4.7-1.8-6.3-3.2.1 1.9 0 4-.4 6.4-.4-2.4-.6-4.6-.4-6.4-1.6 1.4-3.7 2.5-6.3 3.2 1-2.4 2.6-4.4 4.6-6-2.2-.1-4.4-.8-6.4-2 2.1-1 4.3-1.5 6.5-1.6C6.4 9.7 4.6 7.8 3.4 5.6c2.5.7 4.6 1.7 6.3 3C11.5 6.6 11.6 4.4 12 2z"/>
              </svg>
            </div>
            <div class="brandText">
              <h1 id="brandName">TARATERA</h1>
              <p id="brandSub">CATALOG</p>
            </div>
          </div>

          <div class="bubble" aria-label="price bubble">
            <div class="t1">PRICES</div>
            <div class="t2">Starting at</div>
            <div class="big" id="priceStart">80.-</div>
            <div class="unit" id="priceUnit">THB</div>
          </div>
        </div>

        <div class="strip" role="note">
          <div class="stripLabel">PRICING</div>
          <div class="stripNotes">
            <div><span class="dot"></span><span id="note1">Minimum order 5,000 THB.</span></div>
            <div><span class="dot"></span><span id="note2">Prices subject to quantity.</span></div>
          </div>
        </div>
      </header>

      <section class="controls">
        <div id="seg"></div>

        <div class="search">
          <input id="q" type="search" placeholder="Search name / tag…" autocomplete="off">
        </div>
      </section>

      <main class="content">
        <div class="masonry" id="masonry"></div>
      </main>

    </div>
  </div>

  <script>
    // ===== Theme config =====
    const CONFIG = {
      brandName: "TARATERA",
      brandSub: "FLOWERS",
      priceStart: "80.-",
      priceUnit: "THB",
      note1: "Minimum order 5,000 THB.",
      note2: "Prices subject to quantity."
    };

    // ===== Terpene colors (your mapping) =====
    const TERPENE_COLORS = {
      MYRCENE: "#2b398c",
      CARYOPHYLLENE: "#77823d",
      HUMULENE: "#fd8b03",
      LIMONENE: "#7bc70f",
      OCIMENE: "#009282",
      PHELLANDRENE: "#fd0106",
      PINENE: "#08a152",
      TERPINOLENE: "#4b5e3d",
      TERPINEOL: "#ee5a29",
      LINALOOL: "#9094d8",
      BISABOLOL: "#e6c122",
    };

    // ===== Demo DATA (replace later) =====
    const DATA = [
      {
        category: "SATIVA",
        rightColTitle: "A / B",
        items: [
          { name:"PINEAPPLE XPRESS 2.0", badges:["BEST"], tags:["MYRCENE (CITRUS)", "PINENE (FLORAL)"], meta:{a:"32–35%", b:"1–2%"} },
          { name:"LEMON UPZ", badges:["NEW"], tags:["LIMONENE (CITRUS)", "CARYOPHYLLENE (FRUIT)"], meta:{a:"24–28%", b:"0%"} },
          { name:"TROP CHERRY GAS #14", badges:["BEST","RECOMMENDED"], tags:["MYRCENE (FRUIT)", "OCIMENE (FLORAL)"], meta:{a:"20–22%", b:"0%"} },
          { name:"SUNRISE SPLASH", badges:[], tags:["TERPINOLENE (CITRUS)", "PINENE (FLORAL)"], meta:{a:"19–23%", b:"0%"} },
        ]
      },
      {
        category: "INDICA",
        rightColTitle: "A / B",
        items: [
          { name:"CASHEW SUNDAE", badges:["BEST"], tags:["BISABOLOL (FRUIT)", "HUMULENE (FLORAL)"], meta:{a:"20–24%", b:"<1%"} },
          { name:"BLACK GARLIC", badges:["NEW"], tags:["MYRCENE (FLORAL)", "HUMULENE (CITRUS)"], meta:{a:"23–27%", b:"<1%"} },
          { name:"MIDNIGHT SILK", badges:["RECOMMENDED"], tags:["LINALOOL (FLORAL)", "CARYOPHYLLENE (FRUIT)"], meta:{a:"18–21%", b:"<1%"} },
        ]
      },
      {
        category: "HYBRID",
        rightColTitle: "A / B",
        items: [
          { name:"CAP JUNKY", badges:["NEW"], tags:["LIMONENE (FRUIT)", "CARYOPHYLLENE (FLORAL)"], meta:{a:"23–27%", b:"<1%"} },
          { name:"OREOZ", badges:["RECOMMENDED"], tags:["CARYOPHYLLENE (FRUIT)", "MYRCENE (CITRUS)"], meta:{a:"20–24%", b:"0%"} },
        ]
      },
      /* เพิ่ม panel เพื่อดู 3 คอลัมน์แน่น ๆ */
      {
        category: "SPECIALS",
        rightColTitle: "A / B",
        items: [
          { name:"WEEKLY PICK 01", badges:["BEST"], tags:["PHELLANDRENE (FRUIT)", "OCIMENE (FLORAL)"], meta:{a:"25–29%", b:"0%"} },
          { name:"WEEKLY PICK 02", badges:["NEW"], tags:["TERPINEOL (CITRUS)", "PINENE (FLORAL)"], meta:{a:"21–24%", b:"0%"} },
          { name:"WEEKLY PICK 03", badges:["RECOMMENDED"], tags:["MYRCENE (FRUIT)", "LINALOOL (FLORAL)"], meta:{a:"19–22%", b:"<1%"} },
        ]
      },
    ];

    // ===== DOM =====
    const el = {
      brandName: document.getElementById("brandName"),
      brandSub: document.getElementById("brandSub"),
      priceStart: document.getElementById("priceStart"),
      priceUnit: document.getElementById("priceUnit"),
      note1: document.getElementById("note1"),
      note2: document.getElementById("note2"),
      seg: document.getElementById("seg"),
      q: document.getElementById("q"),
      masonry: document.getElementById("masonry"),
    };

    // apply config
    el.brandName.textContent = CONFIG.brandName;
    el.brandSub.textContent  = CONFIG.brandSub;
    el.priceStart.textContent = CONFIG.priceStart;
    el.priceUnit.textContent = CONFIG.priceUnit;
    el.note1.textContent = CONFIG.note1;
    el.note2.textContent = CONFIG.note2;

    let active = "ALL";
    const categories = ["ALL", ...DATA.map(d => d.category)];

    function escapeHtml(s){
      return String(s ?? "")
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    function terpeneTagHtml(text){
      const raw = String(text || "").trim();
      const key = raw.split("(")[0].trim().toUpperCase();
      const color = TERPENE_COLORS[key];

      if(!color){
        return `<span class="tag">${escapeHtml(raw)}</span>`;
      }

      return `
        <span class="tag" style="
          color:${color};
          background: color-mix(in srgb, ${color} 14%, white);
          border-color: color-mix(in srgb, ${color} 34%, transparent);
        ">
          ${escapeHtml(raw)}
        </span>
      `;
    }

    function badgeHtml(b){
      const norm = String(b || "").toUpperCase().trim();
      if(!norm) return "";

      // เข้าธีม: BEST / RECOMMENDED = ทึบ CI, NEW = outline CI
      if(norm === "BEST") return `<span class="badge best">BEST SELLER</span>`;
      if(norm === "RECOMMENDED") return `<span class="badge reco">RECOMMENDED</span>`;
      if(norm === "NEW") return `<span class="badge new">NEW</span>`;

      return `<span class="badge">${escapeHtml(norm)}</span>`;
    }

    function renderSeg(){
      el.seg.innerHTML = categories.map(c=>{
        const cls = (c === active) ? "chip active" : "chip";
        return `<button type="button" class="${cls}" data-cat="${escapeHtml(c)}">${escapeHtml(c)}</button>`;
      }).join("");

      el.seg.querySelectorAll("button").forEach(btn=>{
        btn.addEventListener("click", ()=>{
          active = btn.dataset.cat;
          renderSeg();
          renderPanels();
        });
      });
    }

    function renderItem(it){
      const badgeList = (it.badges || []).slice(0, 2); // กันรก: ไม่เกิน 2 ป้าย
      const badges = badgeList.map(badgeHtml).join("");

      const tags = (it.tags || []).map(terpeneTagHtml).join("");

      const metaA = it.meta?.a ? `<span class="k">A</span><span class="v">${escapeHtml(it.meta.a)}</span>` : "";
      const metaB = it.meta?.b ? `<span class="k">B</span><span class="v">${escapeHtml(it.meta.b)}</span>` : "";

      return `
        <article class="item">
          <div>
            <div class="titleLine">
              <div class="badges">${badges}</div>
              <div class="name">${escapeHtml(it.name)}</div>
            </div>
            <div class="tags">${tags}</div>
          </div>

          <div class="meta">
            ${metaA}
            ${metaB ? `<div style="height:10px"></div>${metaB}` : ""}
          </div>
        </article>
      `;
    }

    function emptyState(){
      return `
        <div class="empty">
          <div class="t">No results</div>
          <div class="d">Try another search or switch category.</div>
        </div>
      `;
    }

    function renderPanels(){
      const q = (el.q.value || "").trim().toLowerCase();

      const panels = DATA
        .filter(p => active === "ALL" ? true : p.category === active)
        .map(p=>{
          const items = (p.items || []).filter(it=>{
            if(!q) return true;
            const hay = [
              it.name,
              ...(it.badges||[]),
              ...(it.tags||[]),
              it.meta?.a, it.meta?.b
            ].join(" ").toLowerCase();
            return hay.includes(q);
          });

          if(!items.length) return "";

          return `
            <section class="panel">
              <div class="panelHead">
                <h2>${escapeHtml(p.category)}</h2>
                <div class="colTitle">${escapeHtml(p.rightColTitle || "")}</div>
              </div>
              <div class="rows">
                ${items.map(renderItem).join("")}
              </div>
            </section>
          `;
        }).join("");

      el.masonry.innerHTML = panels || emptyState();
    }

    el.q.addEventListener("input", renderPanels);

    renderSeg();
    renderPanels();
  </script>
</body>
</html>
